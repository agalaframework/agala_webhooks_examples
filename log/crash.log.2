2018-07-06 14:04:24 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.312.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 14:05:59 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.304.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 14:05:59 =CRASH REPORT====
  crasher:
    initial call: application_master:init/4
    pid: <0.375.0>
    registered_name: []
    exception exit: {{bad_return,{{'Elixir.Awe',start,[normal,[]]},{'EXIT',{undef,[{'Elixir.Plug.Adapters.Cowboy2',child_spec,[http,'Elixir.AgalaWebhooksExamples.Router',[],[{port,8080}]],[]},{'Elixir.Awe',start,2,[{file,"lib/awe.ex"},{line,7}]},{application_master,start_it_old,4,[{file,"application_master.erl"},{line,273}]}]}}}},[{application_master,init,4,[{file,"application_master.erl"},{line,134}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.374.0>]
    message_queue_len: 1
    messages: [{'EXIT',<0.376.0>,normal}]
    links: [<0.374.0>,<0.33.0>]
    dictionary: []
    trap_exit: true
    status: running
    heap_size: 610
    stack_size: 27
    reductions: 187
  neighbours:
2018-07-06 14:07:26 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.265.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 14:09:22 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.264.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 14:12:03 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.283.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 19:07:25 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.542.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.FunctionClauseError',args => nil,arity => 4,clauses => nil,function => do_match,kind => nil,module => 'Elixir.Awe.Router'},[{'Elixir.Awe.Router',do_match,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62283},pid => <0.541.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.542.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},<<"GET">>,[],<<"a022843c.ngrok.io">>],[{file,"lib/router.ex"},{line,9}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62283},pid => <0.541.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.542.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.541.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.541.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 2586
    stack_size: 27
    reductions: 527
  neighbours:
2018-07-06 19:07:25 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.541.0>, stream 1 had its request process <0.542.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.FunctionClauseError',args => nil,arity => 4,clauses => nil,function => do_match,kind => nil,module => 'Elixir.Awe.Router'},[{'Elixir.Awe.Router',do_match,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62283},pid => <0.541.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.542.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},<<"GET">>,[],<<"a022843c.ngrok.io">>],[{file,"lib/router.ex"},{line,9}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62283},pid => <0.541.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.542.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:07:26 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.545.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.FunctionClauseError',args => nil,arity => 4,clauses => nil,function => do_match,kind => nil,module => 'Elixir.Awe.Router'},[{'Elixir.Awe.Router',do_match,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"referer">> => <<"https://a022843c.ngrok.io/">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/favicon.ico">>,path_info => undefined,peer => {{127,0,0,1},62285},pid => <0.544.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.545.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"favicon.ico">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"referer">>,<<"https://a022843c.ngrok.io/">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/favicon.ico">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},<<"GET">>,[<<"favicon.ico">>],<<"a022843c.ngrok.io">>],[{file,"lib/router.ex"},{line,9}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"referer">> => <<"https://a022843c.ngrok.io/">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/favicon.ico">>,path_info => undefined,peer => {{127,0,0,1},62285},pid => <0.544.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.545.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"favicon.ico">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"referer">>,<<"https://a022843c.ngrok.io/">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/favicon.ico">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.544.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.544.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 2586
    stack_size: 27
    reductions: 543
  neighbours:
2018-07-06 19:07:26 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.544.0>, stream 1 had its request process <0.545.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.FunctionClauseError',args => nil,arity => 4,clauses => nil,function => do_match,kind => nil,module => 'Elixir.Awe.Router'},[{'Elixir.Awe.Router',do_match,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"referer">> => <<"https://a022843c.ngrok.io/">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/favicon.ico">>,path_info => undefined,peer => {{127,0,0,1},62285},pid => <0.544.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.545.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"favicon.ico">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"referer">>,<<"https://a022843c.ngrok.io/">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/favicon.ico">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},<<"GET">>,[<<"favicon.ico">>],<<"a022843c.ngrok.io">>],[{file,"lib/router.ex"},{line,9}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"br, gzip, deflate">>,<<"accept-language">> => <<"en-us">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"referer">> => <<"https://a022843c.ngrok.io/">>,<<"user-agent">> => <<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>,<<"x-forwarded-for">> => <<"86.57.172.71">>,<<"x-forwarded-proto">> => <<"https">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"GET">>,path => <<"/favicon.ico">>,path_info => undefined,peer => {{127,0,0,1},62285},pid => <0.544.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"GET">>,owner => <0.545.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"favicon.ico">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"br, gzip, deflate">>},{<<"accept-language">>,<<"en-us">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"referer">>,<<"https://a022843c.ngrok.io/">>},{<<"user-agent">>,<<"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15">>},{<<"x-forwarded-for">>,<<"86.57.172.71">>},{<<"x-forwarded-proto">>,<<"https">>}],request_path => <<"/favicon.ico">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:16 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.555.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:8fe8:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62391},pid => <0.554.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.555.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893476205,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:8fe8:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:8fe8:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62391},pid => <0.554.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.555.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:8fe8:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.554.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.554.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:16 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.554.0>, stream 1 had its request process <0.555.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:8fe8:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62391},pid => <0.554.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.555.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893476205,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:8fe8:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:8fe8:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62391},pid => <0.554.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.555.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:8fe8:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=b181ca935de3733064de0315bd10a53628de0ae8">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:16 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.558.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 230,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"230">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:8ff4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62392},pid => <0.557.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.558.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893476365,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893476360,\"read\":{\"watermark\":1530893475743,\"seq\":0}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"230">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:8ff4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 230,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"230">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:8ff4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62392},pid => <0.557.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.558.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"230">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:8ff4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.557.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.557.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:16 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.557.0>, stream 1 had its request process <0.558.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 230,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"230">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:8ff4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62392},pid => <0.557.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.558.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893476365,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893476360,\"read\":{\"watermark\":1530893475743,\"seq\":0}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"230">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:8ff4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 230,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"230">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:8ff4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62392},pid => <0.557.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.558.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"230">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:8ff4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d208f2fe63ff85edffbe31347d0bc14057de0bf3">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:16 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.561.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:bff6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62393},pid => <0.560.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.561.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893476657,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:bff6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:bff6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62393},pid => <0.560.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.561.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:bff6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.560.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.560.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:16 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.560.0>, stream 1 had its request process <0.561.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:bff6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62393},pid => <0.560.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.561.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893476657,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:bff6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1010:bff6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62393},pid => <0.560.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.561.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1010:bff6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=f69ae204feda8c8a5c78147a5f498cbd87c036d6">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:17 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.564.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62394},pid => <0.563.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.564.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893477100,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62394},pid => <0.563.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.564.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.563.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.563.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:17 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.563.0>, stream 1 had its request process <0.564.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62394},pid => <0.563.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.564.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893477100,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62394},pid => <0.563.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.564.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=33cee97ab20a3c0fd3fe2800a244a655b52dbd7e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:18 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.567.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:6fd6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62395},pid => <0.566.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.567.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893477654,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:6fd6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:6fd6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62395},pid => <0.566.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.567.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:6fd6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.566.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.566.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:18 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.566.0>, stream 1 had its request process <0.567.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:6fd6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62395},pid => <0.566.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.567.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893477654,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:6fd6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:6fd6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62395},pid => <0.566.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.567.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:6fd6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=5db863ae94e48949c795e773e888ecafcb1ad56d">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:19 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.570.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:6fe6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62396},pid => <0.569.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.570.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893478829,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:6fe6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:6fe6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62396},pid => <0.569.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.570.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:6fe6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.569.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.569.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:19 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.569.0>, stream 1 had its request process <0.570.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:6fe6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62396},pid => <0.569.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.570.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893478829,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:6fe6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:6fe6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62396},pid => <0.569.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.570.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:6fe6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=2f5f3dfd725512793263b0071a0fde4797311a27">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:22 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.573.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:3fe9:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62398},pid => <0.572.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.573.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893482337,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:3fe9:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:3fe9:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62398},pid => <0.572.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.573.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:3fe9:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.572.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.572.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:22 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.572.0>, stream 1 had its request process <0.573.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:3fe9:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62398},pid => <0.572.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.573.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893482337,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:3fe9:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1020:3fe9:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62398},pid => <0.572.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.573.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1020:3fe9:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=ddb0500ae947a6fc08e48431dc954ae94ff85d3e">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:11:40 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.576.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:bfc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62404},pid => <0.575.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.576.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893500415,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:bfc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:bfc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62404},pid => <0.575.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.576.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:bfc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.575.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.575.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:11:40 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.575.0>, stream 1 had its request process <0.576.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:bfc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62404},pid => <0.575.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.576.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893500415,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:bfc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:bfc6:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62404},pid => <0.575.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.576.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:bfc6:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=fca4d4330776eebdc25827f0e7197709499199bb">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:13:01 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.631.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc3:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62411},pid => <0.630.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.631.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893581402,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc3:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc3:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62411},pid => <0.630.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.631.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc3:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.630.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.630.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:13:01 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.630.0>, stream 1 had its request process <0.631.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc3:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62411},pid => <0.630.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.631.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893581402,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc3:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1030:afc3:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62411},pid => <0.630.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.631.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1030:afc3:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=e4daa7900db1cfedc4e64fd2c9ac1426626e4e7c">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:13:46 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.634.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:3011:6fc5:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62423},pid => <0.633.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.634.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"entry\": [{\"changes\": [{\"field\": \"messages\", \"value\": {\"page_id\": \"1067280970047460\"}}], \"id\": \"0\", \"time\": 1530893621}], \"object\": \"page\"}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:3011:6fc5:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:3011:6fc5:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62423},pid => <0.633.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.634.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:3011:6fc5:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.633.0>,<0.358.0>,<0.357.0>,<0.356.0>,<0.355.0>]
    message_queue_len: 0
    messages: []
    links: [<0.633.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 607
  neighbours:
2018-07-06 19:13:46 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.633.0>, stream 1 had its request process <0.634.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:3011:6fc5:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62423},pid => <0.633.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.634.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANSD4lHGBZCucpFMH2dIR7yBYXpQMSTvph8Upd8C6dzhZCI1b4ImRAngLeHgMZA1x7u9ZCG9OkMU18mu0fVZAGHdJXdgedWbp4fRbaZADZByYGZAG4ZCQgYqturZCx1zLBXBZBpJfq4dMJ3Cu1OUNr90Q56TGi0wLFuFcF1c0uSQgLB">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"entry\": [{\"changes\": [{\"field\": \"messages\", \"value\": {\"page_id\": \"1067280970047460\"}}], \"id\": \"0\", \"time\": 1530893621}], \"object\": \"page\"}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:3011:6fc5:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',call,2,[{file,"lib/receive/plugs/validator.ex"},{line,17}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:3011:6fc5:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62423},pid => <0.633.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.634.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:3011:6fc5:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:14:09 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.291.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 19:14:17 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.472.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:afc4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62424},pid => <0.471.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.472.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANcck3bzhk1KBQ0RQYUTkZA2P5XiU8Qi3WiLEQ2HZBJPQZCmpM2nc8EjipppYh8ICsxXlLhydlsfbCSTFzd94XBXgjgjPaiVk2MyTmepeMVMGtK1oPUFIjwsEzEjw3MR8VOtvfBAyHOEIZCZC1VY30zQZC4G0z1kQQ3ZBZCBZBTzS">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893656902,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:afc4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',validate_signature,2,[{file,"lib/receive/plugs/validator.ex"},{line,35}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:afc4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62424},pid => <0.471.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.472.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:afc4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.471.0>,<0.366.0>,<0.365.0>,<0.364.0>,<0.363.0>]
    message_queue_len: 0
    messages: []
    links: [<0.471.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 1598
    stack_size: 27
    reductions: 805
  neighbours:
2018-07-06 19:14:17 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.471.0>, stream 1 had its request process <0.472.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:afc4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62424},pid => <0.471.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.472.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANcck3bzhk1KBQ0RQYUTkZA2P5XiU8Qi3WiLEQ2HZBJPQZCmpM2nc8EjipppYh8ICsxXlLhydlsfbCSTFzd94XBXgjgjPaiVk2MyTmepeMVMGtK1oPUFIjwsEzEjw3MR8VOtvfBAyHOEIZCZC1VY30zQZC4G0z1kQQ3ZBZCBZBTzS">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"object\":\"page\",\"entry\":[{\"id\":\"730671640616281\",\"time\":1530893656902,\"messaging\":[{\"sender\":{\"id\":\"1468676106567600\"},\"recipient\":{\"id\":\"730671640616281\"},\"timestamp\":1530893475743,\"message\":{\"mid\":\"J97v6JNgKj7-NqXX_Pk0lyGtUuP6avxR5IDQ578-0aIgPv-78yA8-aUUMk0jzhRwJvBGGBi-NxVStT_8FJdkcQ\",\"seq\":2532,\"text\":\"Hello!\"}}]}]}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:afc4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',validate_signature,2,[{file,"lib/receive/plugs/validator.ex"},{line,35}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 321,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"accept-encoding">> => <<"deflate, gzip">>,<<"content-length">> => <<"321">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"facebookexternalua">>,<<"x-forwarded-for">> => <<"2a03:2880:1011:afc4:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62424},pid => <0.471.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.472.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"accept-encoding">>,<<"deflate, gzip">>},{<<"content-length">>,<<"321">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"facebookexternalua">>},{<<"x-forwarded-for">>,<<"2a03:2880:1011:afc4:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=af7786f10a59178f208472d6f715a0d117d9f340">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:14:21 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.475.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:2120:7fc1:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62425},pid => <0.474.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.475.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANcck3bzhk1KBQ0RQYUTkZA2P5XiU8Qi3WiLEQ2HZBJPQZCmpM2nc8EjipppYh8ICsxXlLhydlsfbCSTFzd94XBXgjgjPaiVk2MyTmepeMVMGtK1oPUFIjwsEzEjw3MR8VOtvfBAyHOEIZCZC1VY30zQZC4G0z1kQQ3ZBZCBZBTzS">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"entry\": [{\"changes\": [{\"field\": \"messages\", \"value\": {\"page_id\": \"1067280970047460\"}}], \"id\": \"0\", \"time\": 1530893621}], \"object\": \"page\"}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:2120:7fc1:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',validate_signature,2,[{file,"lib/receive/plugs/validator.ex"},{line,35}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:2120:7fc1:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62425},pid => <0.474.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.475.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:2120:7fc1:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.474.0>,<0.366.0>,<0.365.0>,<0.364.0>,<0.363.0>]
    message_queue_len: 0
    messages: []
    links: [<0.474.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 2586
    stack_size: 27
    reductions: 646
  neighbours:
2018-07-06 19:14:21 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.474.0>, stream 1 had its request process <0.475.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:2120:7fc1:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62425},pid => <0.474.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.475.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANcck3bzhk1KBQ0RQYUTkZA2P5XiU8Qi3WiLEQ2HZBJPQZCmpM2nc8EjipppYh8ICsxXlLhydlsfbCSTFzd94XBXgjgjPaiVk2MyTmepeMVMGtK1oPUFIjwsEzEjw3MR8VOtvfBAyHOEIZCZC1VY30zQZC4G0z1kQQ3ZBZCBZBTzS">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"entry\": [{\"changes\": [{\"field\": \"messages\", \"value\": {\"page_id\": \"1067280970047460\"}}], \"id\": \"0\", \"time\": 1530893621}], \"object\": \"page\"}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:2120:7fc1:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',validate_signature,2,[{file,"lib/receive/plugs/validator.ex"},{line,35}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:2120:7fc1:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62425},pid => <0.474.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.475.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:2120:7fc1:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=d7aac3535333ea98642a1d40161dc5011f470009">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:14:28 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.478.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:30:8fc7:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62432},pid => <0.477.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.478.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANcck3bzhk1KBQ0RQYUTkZA2P5XiU8Qi3WiLEQ2HZBJPQZCmpM2nc8EjipppYh8ICsxXlLhydlsfbCSTFzd94XBXgjgjPaiVk2MyTmepeMVMGtK1oPUFIjwsEzEjw3MR8VOtvfBAyHOEIZCZC1VY30zQZC4G0z1kQQ3ZBZCBZBTzS">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"entry\": [{\"changes\": [{\"field\": \"messages\", \"value\": {\"page_id\": \"1067280970047460\"}}], \"id\": \"0\", \"time\": 1530893664}], \"object\": \"page\"}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:30:8fc7:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',validate_signature,2,[{file,"lib/receive/plugs/validator.ex"},{line,35}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:30:8fc7:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62432},pid => <0.477.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.478.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:30:8fc7:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.477.0>,<0.366.0>,<0.365.0>,<0.364.0>,<0.363.0>]
    message_queue_len: 0
    messages: []
    links: [<0.477.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 2586
    stack_size: 27
    reductions: 646
  neighbours:
2018-07-06 19:14:28 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.477.0>, stream 1 had its request process <0.478.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.UndefinedFunctionError',arity => 2,exports => nil,function => fetch,module => 'Elixir.Plug.Conn',reason => <<"Plug.Conn does not implement the Access behaviour">>},[{'Elixir.Plug.Conn',fetch,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,has_read_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:30:8fc7:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62432},pid => <0.477.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.478.0>,params => #{<<"glob">> => []},path_info => [],path_params => #{<<"glob">> => []},port => 80,private => #{agala_bot_config => #{bot => 'Elixir.Awe.Bots.Fb',chain => 'Elixir.Awe.Chains.Fb',otp_app => awe,provider => 'Elixir.Agala.Provider.Facebook',provider_params => #{app_secret => <<"c986ee78f5794c7fcbc77fb98cd429a0">>,page_access_token => <<"EAADSyqlomHgBANcck3bzhk1KBQ0RQYUTkZA2P5XiU8Qi3WiLEQ2HZBJPQZCmpM2nc8EjipppYh8ICsxXlLhydlsfbCSTFzd94XBXgjgjPaiVk2MyTmepeMVMGtK1oPUFIjwsEzEjw3MR8VOtvfBAyHOEIZCZC1VY30zQZC4G0z1kQQ3ZBZCBZBTzS">>,verify_token => <<"xSGGoYQUoYMH7kmvwdkN">>}},body => <<"{\"entry\": [{\"changes\": [{\"field\": \"messages\", \"value\": {\"page_id\": \"1067280970047460\"}}], \"id\": \"0\", \"time\": 1530893664}], \"object\": \"page\"}">>,plug_route => {<<"/fb/*glob">>,#Fun<Elixir.Awe.Router.1.12520536>}},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:30:8fc7:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [<<"fb">>],secret_key_base => nil,state => unset,status => nil},private],[]},{'Elixir.Access',get,3,[{file,"lib/access.ex"},{line,308}]},{'Elixir.Agala.Provider.Facebook.Plugs.Validator',validate_signature,2,[{file,"lib/receive/plugs/validator.ex"},{line,35}]},{'Elixir.Agala.Provider.Facebook.Plug',plug_builder_call,2,[{file,"lib/receive/plug.ex"},{line,1}]},{'Elixir.Awe.Bots.Fb',plug_builder_call,2,[{file,"lib/bots/fb.ex"},{line,1}]},{'Elixir.Plug.Router.Utils',forward,4,[{file,"lib/plug/router/utils.ex"},{line,92}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 140,cert => undefined,has_body => true,headers => #{<<"accept">> => <<"*/*">>,<<"connection">> => <<"close">>,<<"content-length">> => <<"140">>,<<"content-type">> => <<"application/json">>,<<"host">> => <<"a022843c.ngrok.io">>,<<"user-agent">> => <<"Webhooks/1.0 (https://fb.me/webhooks)">>,<<"x-forwarded-for">> => <<"2a03:2880:30:8fc7:face:b00c:0:8000">>,<<"x-forwarded-proto">> => <<"https">>,<<"x-hub-signature">> => <<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>},host => <<"a022843c.ngrok.io">>,host_info => undefined,method => <<"POST">>,path => <<"/fb">>,path_info => undefined,peer => {{127,0,0,1},62432},pid => <0.477.0>,port => 80,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"a022843c.ngrok.io">>,method => <<"POST">>,owner => <0.478.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [<<"fb">>],path_params => #{},port => 80,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"connection">>,<<"close">>},{<<"content-length">>,<<"140">>},{<<"content-type">>,<<"application/json">>},{<<"host">>,<<"a022843c.ngrok.io">>},{<<"user-agent">>,<<"Webhooks/1.0 (https://fb.me/webhooks)">>},{<<"x-forwarded-for">>,<<"2a03:2880:30:8fc7:face:b00c:0:8000">>},{<<"x-forwarded-proto">>,<<"https">>},{<<"x-hub-signature">>,<<"sha1=145503574ddd65b502b8af514f044cb45ebff8f0">>}],request_path => <<"/fb">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:14:59 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.278.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 19:16:23 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.256.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 19:16:48 =CRASH REPORT====
  crasher:
    initial call: cowboy_stream_h:request_process/3
    pid: <0.440.0>
    registered_name: []
    exception exit: {{{{#{'__exception__' => true,'__struct__' => 'Elixir.FunctionClauseError',args => nil,arity => 4,clauses => nil,function => do_match,kind => nil,module => 'Elixir.Awe.Router'},[{'Elixir.Awe.Router',do_match,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"host">> => <<"localhost:8080">>,<<"user-agent">> => <<"curl/7.54.0">>},host => <<"localhost">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62447},pid => <0.439.0>,port => 8080,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"localhost">>,method => <<"GET">>,owner => <0.440.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 8080,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"host">>,<<"localhost:8080">>},{<<"user-agent">>,<<"curl/7.54.0">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},<<"GET">>,[],<<"localhost">>],[{file,"lib/router.ex"},{line,9}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"host">> => <<"localhost:8080">>,<<"user-agent">> => <<"curl/7.54.0">>},host => <<"localhost">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62447},pid => <0.439.0>,port => 8080,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"localhost">>,method => <<"GET">>,owner => <0.440.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 8080,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"host">>,<<"localhost:8080">>},{<<"user-agent">>,<<"curl/7.54.0">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},[{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]}
    ancestors: [<0.439.0>,<0.331.0>,<0.330.0>,<0.329.0>,<0.328.0>]
    message_queue_len: 0
    messages: []
    links: [<0.439.0>]
    dictionary: []
    trap_exit: false
    status: running
    heap_size: 2586
    stack_size: 27
    reductions: 626
  neighbours:
2018-07-06 19:16:49 =ERROR REPORT====
Ranch listener 'Elixir.Awe.Router.HTTP', connection process <0.439.0>, stream 1 had its request process <0.440.0> exit with reason {{#{'__exception__' => true,'__struct__' => 'Elixir.FunctionClauseError',args => nil,arity => 4,clauses => nil,function => do_match,kind => nil,module => 'Elixir.Awe.Router'},[{'Elixir.Awe.Router',do_match,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"host">> => <<"localhost:8080">>,<<"user-agent">> => <<"curl/7.54.0">>},host => <<"localhost">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62447},pid => <0.439.0>,port => 8080,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"localhost">>,method => <<"GET">>,owner => <0.440.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 8080,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"host">>,<<"localhost:8080">>},{<<"user-agent">>,<<"curl/7.54.0">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},<<"GET">>,[],<<"localhost">>],[{file,"lib/router.ex"},{line,9}]},{'Elixir.Awe.Router',plug_builder_call,2,[{file,"lib/router.ex"},{line,1}]},{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,12}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]},{'Elixir.Awe.Router',call,[#{'__struct__' => 'Elixir.Plug.Conn',adapter => {'Elixir.Plug.Adapters.Cowboy2.Conn',#{bindings => #{},body_length => 0,cert => undefined,has_body => false,headers => #{<<"accept">> => <<"*/*">>,<<"host">> => <<"localhost:8080">>,<<"user-agent">> => <<"curl/7.54.0">>},host => <<"localhost">>,host_info => undefined,method => <<"GET">>,path => <<"/">>,path_info => undefined,peer => {{127,0,0,1},62447},pid => <0.439.0>,port => 8080,qs => <<>>,ref => 'Elixir.Awe.Router.HTTP',scheme => <<"http">>,sock => {{127,0,0,1},8080},streamid => 1,version => 'HTTP/1.1'}},assigns => #{},before_send => [],body_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => body_params},cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},halted => false,host => <<"localhost">>,method => <<"GET">>,owner => <0.440.0>,params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => params},path_info => [],path_params => #{},port => 8080,private => #{},query_params => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => query_params},query_string => <<>>,remote_ip => {127,0,0,1},req_cookies => #{'__struct__' => 'Elixir.Plug.Conn.Unfetched',aspect => cookies},req_headers => [{<<"accept">>,<<"*/*">>},{<<"host">>,<<"localhost:8080">>},{<<"user-agent">>,<<"curl/7.54.0">>}],request_path => <<"/">>,resp_body => nil,resp_cookies => #{},resp_headers => [{<<"cache-control">>,<<"max-age=0, private, must-revalidate">>}],scheme => http,script_name => [],secret_key_base => nil,state => unset,status => nil},[]]}} and stacktrace [{'Elixir.Plug.Adapters.Cowboy2.Handler',init,2,[{file,"lib/plug/adapters/cowboy2/handler.ex"},{line,20}]},{cowboy_handler,execute,2,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_handler.erl"},{line,37}]},{cowboy_stream_h,execute,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,274}]},{cowboy_stream_h,request_process,3,[{file,"/Users/virviil/dev/agala/agala_webhooks_examples/deps/cowboy/src/cowboy_stream_h.erl"},{line,252}]},{proc_lib,init_p_do_apply,3,[{file,"proc_lib.erl"},{line,247}]}]
2018-07-06 19:19:21 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.256.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 19:20:28 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.256.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

2018-07-06 19:21:07 =SUPERVISOR REPORT====
     Supervisor: {local,'Elixir.Logger.Supervisor'}
     Context:    child_terminated
     Reason:     normal
     Offender:   [{pid,<0.304.0>},{id,'Elixir.Logger.ErrorHandler'},{mfargs,{'Elixir.Logger.Watcher',start_link,[{error_logger,'Elixir.Logger.ErrorHandler',{true,false,500}}]}},{restart_type,permanent},{shutdown,5000},{child_type,worker}]

